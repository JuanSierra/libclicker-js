var libclicker=function(exports){"use strict";const PurchaseResult={OK:"OK",INSUFFICIENT_FUNDS:"INSUFFICIENT_FUNDS",MAX_LEVEL_REACHED:"MAX_LEVEL_REACHED"};var PurchaseResult_1=PurchaseResult;class Item{constructor(world,name="Nameless Item"){this.world=world;this.modifiers=[];this.basePrice=1;this.name=name;this.description="No description.";this.itemLevel=0;this.maxItemLevel=99999999;this.priceMultiplier=1.145}getName(){return this.name}setName(name){this.name=name}getDescription(){return this.description}setDescription(description){this.description=description}getBasePrice(){return this.basePrice}setBasePrice(basePrice){this.basePrice=basePrice}getPrice(){var tmp=this.basePrice;tmp=tmp*Math.pow(this.priceMultiplier,this.itemLevel);return tmp}buyWith(currency){if(this.itemLevel>=this.maxItemLevel)return PurchaseResult_1.MAX_LEVEL_REACHED;var price=this.getPrice();var result=currency.value-price;if(result<0){return PurchaseResult_1.INSUFFICIENT_FUNDS}currency-=price;this.upgrade();return PurchaseResult_1.OK}setBasePrice(basePrice){if(basePrice==null)throw"Base price cannot be null";if(basePrice==0)throw"Base price cannot be zero";this.basePrice=basePrice}setBasePrice(basePrice){this.basePrice=basePrice}getPriceMultiplier(){return this.priceMultiplier}setPriceMultiplier(multiplier){this.priceMultiplier=multiplier}getMaxItemLevel(){return this.maxItemLevel}setMaxItemLevel(maxLvl){if(maxLvl<=0)throw"Max item level cannot be zero or negative";this.maxItemLevel=maxLvl}getItemLevel(){return this.itemLevel}setItemLevel(lvl){this.itemLevel=lvl<0?0:lvl>this.maxItemLevel?this.maxItemLevel:lvl}upgrade(){if(this.itemLevel<this.maxItemLevel){this.itemLevel++}}downgrade(){if(this.itemLevel>0){this.itemLevel--}}maximize(){this.itemLevel=this.maxItemLevel}}var item=Item;class Automator extends item{constructor(world,name){super(world,name)}static get Builder(){class Builder{constructor(world){this.mWorld=world;this.mGenerator;this.mTickRate=1;this.mTickTimer=0;this.mName="Nameless automator";this.mEnabled=true;this.mBasePrice=999999999;this.mPriceMultiplier=1.1;this.mTickRateMultiplier=1.08}basePrice(name){this.basePrice=name;return this}priceMultiplier(multiplier){this._priceMultiplier=multiplier;return this}tickRateMultiplier(multiplier){this._tickRateMultiplier=multiplier;return this}automate(generator){this.generator=generator;return this}name(name){this.name=name;return this}every(seconds){this.tickRate=seconds;return this}build(){var a=new Automator(this.mWorld,this.name);a.generator=this.generator;a.enabled=this.mEnabled;a.basePrice=this.basePrice;a._priceMultiplier=this._priceMultiplier;a.multiplier=this._tickRateMultiplier;a.tickRate=this.tickRate;a.tickTimer=this.mTickTimer;a.actualTickRate=this.actualTickRate;this.mWorld.addAutomator(a);return a}}return Builder}enable(){if(!this.enabled){this.world.addAutomator(this);this.enabled=true}}disable(){if(this.enabled){this.world.removeAutomator(this);this.enabled=false}}upgrade(){super.upgrade();this.actualTickRate=this.getFinalTickRate()}getFinalTickRate(){if(this.itemLevel==0)return 0;var r=this.tickRate;var m=Math.pow(this.multiplier,this.itemLevel-1);return r/m}update(delta){if(!this.enabled||this.itemLevel==0)return;this.tickTimer+=delta;while(this.tickTimer>=this.actualTickRate){this.tickTimer-=this.actualTickRate;this.generator.process()}}getTickRate(){return this.tickRate}setTickRate(tickRate){this.tickRate=tickRate;if(this.tickRate<0)this.tickRate=0}getTimerPercentage(){return this.tickRate!=0?this.tickTimer/this.tickRate:1}}var automator=Automator;class Currency{constructor(build){this.name=build.mName;this.world=build.world;this.value=0}static get Builder(){class Builder{constructor(world){this.mName="Gold";this.world=world}name(name){this.mName=name;return this}build(){return new Currency(this)}}return Builder}getAmountAsString(){return this.value.toString()}add(amount){this.value=this.value+amount}sub(amount){this.value=this.value-amount}multiply(multiplier){this.value=this.value*multiplier}set(newValue){this.value=newValue}equals(a,b){return JSON.stringify(a)===JSON.stringify(b)}}var currency=Currency;if(!Array.prototype.contains){Array.prototype.contains=function(element){for(var i in this){if(element===this[i]){return true}}return false}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(element){for(var i in this){if(element===this[i]){return i}}return-1}}if(!Array.prototype.remove){Array.prototype.remove=function(element){var i=this.indexOf(element);if(i>=0){this.splice(i,1)}}}class World{constructor(){this.generators=[];this.automators=[];this.currencies=[];this.modifiers=[];this._speedMultiplier=1;this._updateAutomators=true}equals(a,b){return JSON.stringify(a)===JSON.stringify(b)}addGenerator(generator){if(generator&&!this.generators.contains(generator)){this.generators.push(generator)}}getGeneratorCount(){return this.generators.length}removeGenerator(generator){if(generator&&this.generators.contains(generator)){this.generators.remove(generator)}}removeAllGenerators(){generators=[]}addCurrency(c){if(c&&!this.currencies.contains(c)){this.currencies.push(c)}}removeCurrency(c){if(c){this.currencies.remove(c)}}getCurrency(index){return this.currencies[index]}getCurrencies(){return this.currencies}removeAllCurrencies(){this.currencies=[]}update(seconds){seconds*=this._speedMultiplier;if(this._updateAutomators){this.automators.forEach(function(a){a.update(seconds)})}}addAutomator(automator){if(automator&&!this.automators.contains(automator)){this.automators.push(automator)}}addModifier(modifier){if(modifier&&!this.modifiers.contains(modifier)){this.modifiers.push(modifier)}}getSpeedMultiplier(){return this._speedMultiplier}setSpeedMultiplier(multiplier){this._speedMultiplier=multiplier}disableAutomators(){this._updateAutomators=false}enableAutomators(){this._updateAutomators=true}removeAutomator(automator){if(automator!=null){this.automators.remove(automator)}}getAutomators(){return this.automators}getModifiers(){return this.modifiers}removeModifier(modifier){if(modifier){this.modifiers.remove(modifier)}}isAutomationEnabled(){return this._updateAutomators}}var world=World;class Generator extends item{constructor(build){super(build.mWorld,build.mName);this.maxItemLevel=build.mMaxLevel;this.amountMultiplier=build.mAmountMultiplier;this.useRemainder=build.mUseRemainder;this.timesProcessed=build.mTimesProcessed;this.currency=build.mCurrency;this.baseAmount=build.mBaseAmount;this.remainder=0;this.modifiers=[]}static get Builder(){class Builder{constructor(world){this.mWorld=world;this.mName="Nameless generator";this.mOnProcessed=null;this.mCurrency=null;this.mBaseAmount=1;this.mAmountMultiplier=1.1;this.mMaxLevel=999999999;this.mBasePrice=999999999;this.mPriceMultiplier=1.1;this.mProbability=1;this.mProbabilitySet=false;this.mUseRemainder=true;this.mCooldown=0;this.mTimesProcessed=0}cooldown(cooldown){this.cooldown=cooldown;return this}useRemainder(){this.useRemainder=true;return this}discardRemainder(){this.useRemainder=false;return this}name(name){this.name=name;return this}multiplier(multiplier){this.mAmountMultiplier=multiplier;return this}baseAmount(amount){if(amount==null)throw"Base amount cannot be null";this.mBaseAmount=amount;return this}generate(resource){if(resource==null)throw"Currency cannot be null";this.mCurrency=resource;return this}callback(callback){this.onProcessed=callback;return this}price(price){this.basePrice=price;return this}priceMultiplier(multiplier){this.priceMultiplier=multiplier;return this}probability(probability){if(probability<0||probability>1)throw"Probability should be between 0.0 and 1.0";this.probability=probability;this.probabilitySet=true;return this}build(){return new Generator(this)}}return Builder}equals(a,b){return JSON.stringify(a)===JSON.stringify(b)}upgrade(){if(this.itemLevel<this.maxItemLevel){this.itemLevel++}}downgrade(){if(this.itemLevel>0){this.itemLevel--}}getGeneratedAmount(){if(this.itemLevel==0)return 0;var tmp=this.baseAmount;tmp=tmp*Math.pow(this.amountMultiplier,this.itemLevel-1);if(this.useRemainder){var tmpRem=tmp%1;this.remainder+=tmpRem;if(this.remainder>=.999){this.remainder-=1;tmp=tmp+1}}tmp=this.processModifiers(tmp);return parseInt(tmp)}processModifiers(val){if(this.modifiers.length==0)return val;for(var i=0;i<this.modifiers.length;i++){var d=this.modifiers[i].getMultiplier();if(d!=1){val=val*d}}return val}isWorking(){if(this.itemLevel>0){if(!this.useProbability||Math.Random()<this.probability)return true}return false}process(){if(this.isWorking()){this.currency.add(this.getGeneratedAmount());this.timesProcessed++}}getTimesProcessed(){return this.timesProcessed}attachModifier(modifier){if(modifier&&!this.modifiers.contains(modifier)){this.modifiers.push(modifier)}}detachModifier(modifier){if(modifier){this.modifiers.remove(modifier)}}}var generator=Generator;class WorldTarget{constructor(world){this.mWorld=world;this.mSpeedMultiplier=1;this.mDisableActivators=false}speedBy(multiplier){this.mSpeedMultiplier=multiplier;return this}disableActivators(){this.mDisableActivators=true;return this}build(){var m=new WorldModifier(this.mWorld);m.mSpeedMultiplier=this.mSpeedMultiplier;m.mDisableActivators=this.mDisableActivators;return m}}class GeneratorTarget{constructor(gen){this.mGenerator=gen;this.mMultiplier=1}multiplier(multiplier){this.mMultiplier=multiplier;return this}build(){var m=new GeneratorModifier(this.mGenerator);m.mMultiplier=this.mMultiplier;return m}}let Modifier$1=class Modifier extends item{constructor(world,name){super(world,name);this.mEnable=false}static get Builder(){class Builder{constructor(){}modify(obj){if(obj instanceof world)return new WorldTarget(obj);if(obj instanceof generator)return new GeneratorTarget(obj)}}return Builder}enable(){if(!this.mEnabled){this.mEnabled=true;this.world.addModifier(this);this.onEnable()}}disable(){if(this.mEnabled){this.onDisable();this.world.removeModifier(this);this.mEnabled=false}}isEnabled(){return this.mEnabled}};class WorldModifier extends Modifier$1{constructor(world){super(world);this.mSpeedMultiplier;this.mDisableActivators;this.mSpeedMultiplierBefore;this.mSpeedMultiplierAfter}onEnable(){if(this.mSpeedMultiplier!=1){this.mSpeedMultiplierBefore=this.world.getSpeedMultiplier();this.mSpeedMultiplierAfter=this.mSpeedMultiplier*this.mSpeedMultiplierBefore;this.world.setSpeedMultiplier(this.mSpeedMultiplierAfter)}if(this.mDisableActivators){this.world.disableAutomators()}}onDisable(){if(this.mSpeedMultiplier!=1){var d=this.world.getSpeedMultiplier();d/=this.mSpeedMultiplier;this.world.setSpeedMultiplier(d)}if(this.mDisableActivators){this.world.enableAutomators()}}modify(world){return new WorldTarget(world)}}class GeneratorModifier extends Modifier$1{constructor(generator){super(generator.world);this.mGenerator=generator;this.mMultiplier=1}onEnable(){this.mGenerator.attachModifier(this)}onDisable(){this.mGenerator.detachModifier(this)}getMultiplier(){return this.mMultiplier}}var modifier={WorldTarget:WorldTarget,GeneratorTarget:GeneratorTarget,Modifier:Modifier$1,WorldModifier:WorldModifier,GeneratorModifier:GeneratorModifier};const{Modifier}=modifier;var libclicker={Item:item,Creator:generator,Automator:automator,Currency:currency,World:world,Modifier:Modifier};var libclicker_1=libclicker.Item;var libclicker_2=libclicker.Creator;var libclicker_3=libclicker.Automator;var libclicker_4=libclicker.Currency;var libclicker_5=libclicker.World;var libclicker_6=libclicker.Modifier;exports.Automator=libclicker_3;exports.Creator=libclicker_2;exports.Currency=libclicker_4;exports.Item=libclicker_1;exports.Modifier=libclicker_6;exports.World=libclicker_5;exports.default=libclicker;Object.defineProperty(exports,"__esModule",{value:true});return exports}({});